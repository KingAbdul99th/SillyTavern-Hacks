import*as t from"../../../../../script.js";import*as e from"../../../../../scripts/instruct-mode.js";import*as r from"../../../../../scripts/nai-settings.js";var o={d:(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const n=(t=>{var e={};return o.d(e,t),e})({substituteParams:()=>t.substituteParams});const s=(t=>{var e={};return o.d(e,t),e})({formatInstructModeChat:()=>e.formatInstructModeChat,formatInstructModePrompt:()=>e.formatInstructModePrompt,formatInstructModeSystemPrompt:()=>e.formatInstructModeSystemPrompt});const a=(t=>{var e={};return o.d(e,t),e})({adjustNovelInstructionPrompt:()=>r.adjustNovelInstructionPrompt}),m=SillyTavern.getContext();function i(t,e,r,o,i){let d=t;const c=m.powerUserSettings.instruct.enabled&&"openai"!==e&&"novel"!==e&&!r;return i&&(i=(0,n.substituteParams)(i),i=c?(0,s.formatInstructModeSystemPrompt)(i):i,d="openai"===e?d:`${i}\n${d}`),d=(0,n.substituteParams)(d),d="novel"===e?(0,a.adjustNovelInstructionPrompt)(d):d,d=c?(0,s.formatInstructModeChat)(name1,d,!1,!0,"",name1,name2,!1):d,d=c?d+(0,s.formatInstructModePrompt)(name2,!1,"",name1,name2,!0,o):d+"\n",d}console.log("[Hacks] Initialize"),function(){const t=document.getElementById("rm_extensions_block"),e=t?.childNodes[1];e?.removeChild(e.childNodes[11]),e?.removeChild(e.childNodes[9])}(),SillyTavern.buildPrompt=i,function(){const t=m.SlashCommandParser,e=m.SlashCommand,r=m.SlashCommandNamedArgument,o=m.SlashCommandArgument,n=m.ARGUMENT_TYPE;t.addCommandObject(e.fromProps({name:"hacks-command",callback:(t,e)=>Array(t.times??5).fill(e.toString()).join(" "),aliases:["example-hack-command"],returns:"the repeated text",namedArgumentList:[r.fromProps({name:"times",description:"number of times to repeat the text",typeLisst:n.NUMBER,defaultValue:"5"})],unnamedArgumentList:[o.fromProps({description:"the text to repeat",typeList:n.STRING,isRequired:!0})],helpSString:'\n                    <div>\n                        Repeats the provided text a number of times.\n                    </div>\n                    <div>\n                        <strong>Example:</strong>\n                        <ul>\n                            <li>\n                                <pre><code class="language-stscript">/repeat foo</code></pre>\n                                returns "foofoofoofoofoo"\n                            </li>\n                            <li>\n                                <pre><code class="language-stscript">/repeat times=3 space=on bar</code></pre>\n                                returns "bar bar bar"\n                            </li>\n                        </ul>\n                    </div>\n                '}))}();export{m as globalContext};